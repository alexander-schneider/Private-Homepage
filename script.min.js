const dropZone=document.getElementById("pitch-drop-zone"),fileInput=document.getElementById("file-input"),uploadStatus=document.getElementById("upload-status"),statusText=document.getElementById("status-text"),progressBar=document.getElementById("progress-bar");let uploadComplete=!1;dropZone.addEventListener("click",()=>{uploadComplete||fileInput.click()}),dropZone.addEventListener("keydown",e=>{!uploadComplete&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),fileInput.click())}),fileInput.addEventListener("change",e=>{const t=e.target.files[0];t&&handleFile(t)}),dropZone.addEventListener("dragover",e=>{e.preventDefault(),uploadComplete||dropZone.classList.add("drag-over")}),dropZone.addEventListener("dragleave",()=>{dropZone.classList.remove("drag-over")}),dropZone.addEventListener("drop",e=>{if(e.preventDefault(),dropZone.classList.remove("drag-over"),!uploadComplete){const t=e.dataTransfer.files[0];t&&handleFile(t)}});async function handleFile(e){if(uploadComplete)return;const t=["application/pdf","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"];if(!t.includes(e.type))return void alert("Please upload a PDF, PPT, or PPTX file.");if(e.size>10485760)return void alert("File size must be less than 10MB.");uploadStatus.style.display="block",statusText.textContent=`Uploading ${e.name}...`,dropZone.classList.add("uploading"),progressBar.style.width="0%";const o=new FormData;o.append("UPLOADCARE_PUB_KEY","40a891103e90c0934b6f"),o.append("UPLOADCARE_STORE","1"),o.append("file",e);try{const t=await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:o});if(t.ok){const o=await t.json(),a=`https://ucarecdn.com/${o.file}/`,n=new FormData;n.append("email","contact@innos.capital"),n.append("subject","New Pitch Deck Received"),n.append("message",`
New pitch deck submission:

Filename: ${e.name}
Size: ${(e.size/1024/1024).toFixed(2)}MB
Type: ${e.type}
Date: ${(new Date).toLocaleString("de-DE")}

Download link: ${a}
            `.trim()),await fetch("https://formspree.io/f/xvgrknbd",{method:"POST",body:n,headers:{Accept:"application/json"}}),progressBar.style.width="100%",dropZone.classList.remove("uploading"),dropZone.classList.add("success","complete"),uploadComplete=!0;dropZone.querySelector("div").innerHTML=`
                <svg class="drop-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h3 class="drop-title">Vielen Dank!</h3>
                <p class="drop-subtitle">Ihr Pitch Deck wurde erfolgreich übermittelt.</p>
                <p class="drop-info">Wir melden uns in Kürze bei Ihnen.</p>
            `,dropZone.style.cursor="default",setTimeout(()=>{uploadStatus.style.display="none"},2e3)}else throw new Error("Upload failed")}catch(e){console.error("Upload error:",e),dropZone.classList.remove("uploading"),statusText.textContent="Upload failed. Please try again or email directly.",progressBar.style.width="0%",setTimeout(()=>{resetUpload()},3e3)}}function resetUpload(){uploadComplete||(dropZone.classList.remove("uploading","success"),uploadStatus.style.display="none",progressBar.style.width="0%",fileInput.value="")}