const dropZone=document.getElementById("pitch-drop-zone"),fileInput=document.getElementById("file-input"),uploadStatus=document.getElementById("upload-status"),statusText=document.getElementById("status-text"),progressBar=document.getElementById("progress-bar");dropZone.addEventListener("click",()=>{fileInput.click()}),dropZone.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),fileInput.click())}),fileInput.addEventListener("change",e=>{const t=e.target.files[0];t&&handleFile(t)}),dropZone.addEventListener("dragover",e=>{e.preventDefault(),dropZone.classList.add("drag-over")}),dropZone.addEventListener("dragleave",()=>{dropZone.classList.remove("drag-over")}),dropZone.addEventListener("drop",e=>{e.preventDefault(),dropZone.classList.remove("drag-over");const t=e.dataTransfer.files[0];t&&handleFile(t)});async function handleFile(e){const t=["application/pdf","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"];if(!t.includes(e.type))return void alert("Please upload a PDF, PPT, or PPTX file.");if(e.size>10485760)return void alert("File size must be less than 10MB.");uploadStatus.style.display="block",statusText.textContent=`Uploading ${e.name}...`,dropZone.classList.add("uploading"),progressBar.style.width="0%";const o=new FormData;o.append("UPLOADCARE_PUB_KEY","40a891103e90c0934b6f"),o.append("UPLOADCARE_STORE","1"),o.append("file",e);try{const t=await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:o});if(t.ok){const o=await t.json(),s=`https://ucarecdn.com/${o.file}/`,a=new FormData;a.append("email","contact@innos.capital"),a.append("subject","New Pitch Deck Received"),a.append("message",`
New pitch deck submission:

Filename: ${e.name}
Size: ${(e.size/1024/1024).toFixed(2)}MB
Type: ${e.type}
Date: ${(new Date).toLocaleString("de-DE")}

Download link: ${s}
            `.trim()),await fetch("https://formspree.io/f/xvgrknbd",{method:"POST",body:a,headers:{Accept:"application/json"}}),progressBar.style.width="100%",dropZone.classList.remove("uploading"),dropZone.classList.add("success"),statusText.textContent="Pitch deck uploaded successfully!",setTimeout(()=>{resetUpload()},5e3)}else throw new Error("Upload failed")}catch(e){console.error("Upload error:",e),dropZone.classList.remove("uploading"),statusText.textContent="Upload failed. Please try again or email directly.",progressBar.style.width="0%",setTimeout(()=>{resetUpload()},3e3)}}function resetUpload(){dropZone.classList.remove("uploading","success"),uploadStatus.style.display="none",progressBar.style.width="0%",fileInput.value=""}