const dropZone=document.getElementById("pitch-drop-zone"),fileInput=document.getElementById("file-input"),uploadStatus=document.getElementById("upload-status"),statusText=document.getElementById("status-text"),progressBar=document.getElementById("progress-bar");let uploadComplete=!1;const VALID_FILE_TYPES=["application/pdf","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],MAX_FILE_SIZE=10485760,UPLOADCARE_PUBLIC_KEY="40a891103e90c0934b6f";function triggerFileSelect(){uploadComplete||fileInput.click()}function showUploadProgress(e){uploadStatus.style.display="block",statusText.textContent=`Uploading ${e}...`,dropZone.classList.add("uploading"),progressBar.style.width="0%"}function formatFileSize(e){return(e/1024/1024).toFixed(2)}async function sendNotification(e,t){const o=new FormData;o.append("email","contact@innos.capital"),o.append("subject","New Pitch Deck Received"),o.append("message",["New pitch deck submission:","",`Filename: ${e.name}`,`Size: ${formatFileSize(e.size)}MB`,`Type: ${e.type}`,`Date: ${new Date().toLocaleString("de-DE")}`,"",`Download link: ${t}`].join("\n")),await fetch("https://formspree.io/f/xvgrknbd",{method:"POST",body:o,headers:{Accept:"application/json"}})}function showUploadSuccess(){progressBar.style.width="100%",dropZone.classList.remove("uploading"),dropZone.classList.add("success","complete"),uploadComplete=!0,dropZone.querySelector("div").innerHTML='<svg class="drop-icon" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round"/></svg><h3 class="drop-title">Vielen Dank!</h3><p class="drop-subtitle">Ihr Pitch Deck wurde erfolgreich übermittelt.</p><p class="drop-info">Wir melden uns in Kürze bei Ihnen.</p>',dropZone.style.cursor="default",setTimeout(()=>{uploadStatus.style.display="none"},2e3)}function showUploadError(){dropZone.classList.remove("uploading"),statusText.textContent="Upload failed. Please try again or email directly.",progressBar.style.width="0%",setTimeout(resetUpload,3e3)}function resetUpload(){uploadComplete||(dropZone.classList.remove("uploading","success"),uploadStatus.style.display="none",progressBar.style.width="0%",fileInput.value="")}async function handleFile(e){if(uploadComplete)return;if(!VALID_FILE_TYPES.includes(e.type))return void alert("Please upload a PDF, PPT, or PPTX file.");if(e.size>MAX_FILE_SIZE)return void alert("File size must be less than 10MB.");showUploadProgress(e.name);const t=new FormData;t.append("UPLOADCARE_PUB_KEY",UPLOADCARE_PUBLIC_KEY),t.append("UPLOADCARE_STORE","1"),t.append("file",e);try{const o=await fetch("https://upload.uploadcare.com/base/",{method:"POST",body:t});if(!o.ok)throw new Error("Upload failed");const s=await o.json(),a=`https://ucarecdn.com/${s.file}/`;await sendNotification(e,a),showUploadSuccess()}catch(e){console.error("Upload error:",e),showUploadError()}}dropZone.addEventListener("click",triggerFileSelect),dropZone.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),triggerFileSelect())}),fileInput.addEventListener("change",e=>{e.target.files[0]&&handleFile(e.target.files[0])}),dropZone.addEventListener("dragover",e=>{e.preventDefault(),uploadComplete||dropZone.classList.add("drag-over")}),dropZone.addEventListener("dragleave",()=>{dropZone.classList.remove("drag-over")}),dropZone.addEventListener("drop",e=>{e.preventDefault(),dropZone.classList.remove("drag-over"),!uploadComplete&&e.dataTransfer.files[0]&&handleFile(e.dataTransfer.files[0])});
